<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم متجر خيران</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* التصميم العام */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            color: #e0e1dd;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* شاشة تسجيل الدخول */
        #login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .login-container {
            background: linear-gradient(145deg, #1b263b, #0d1b2a);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .login-logo {
            font-size: 3rem;
            color: #a8dadc;
            margin-bottom: 20px;
        }

        .login-title {
            color: #a8dadc;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .login-input {
            padding: 15px;
            background: rgba(13, 27, 42, 0.7);
            border: 1px solid #415a77;
            border-radius: 8px;
            color: #e0e1dd;
            font-size: 1rem;
            text-align: center;
        }

        .login-input:focus {
            outline: none;
            border-color: #a8dadc;
            box-shadow: 0 0 0 2px rgba(168, 218, 220, 0.3);
        }

        .login-button {
            background: linear-gradient(to right, #2a9d8f, #1d6b5e);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .login-button:hover {
            background: linear-gradient(to right, #1d6b5e, #2a9d8f);
            transform: translateY(-3px);
        }

        .login-error {
            color: #e63946;
            margin-top: 15px;
            display: none;
        }

        /* القائمة الرئيسية */
        .admin-nav {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(145deg, #1b263b, #0d1b2a);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-button {
            background: linear-gradient(to right, #457b9d, #1d3557);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(29, 53, 87, 0.4);
        }

        .nav-button:hover {
            background: linear-gradient(to right, #1d3557, #457b9d);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(29, 53, 87, 0.6);
        }

        .nav-button.active {
            background: linear-gradient(to right, #e63946, #c1121f);
        }

        /* المحتوى الرئيسي */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* قسم المنتجات */
        .section-title {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #a8dadc;
            position: relative;
            padding-bottom: 15px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 4px;
            background: linear-gradient(90deg, transparent, #a8dadc, transparent);
            border-radius: 2px;
        }

        /* جدول المنتجات */
        .products-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background: rgba(27, 38, 59, 0.7);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .products-table th, .products-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #415a77;
        }

        .products-table th {
            background: #1d3557;
            color: #a8dadc;
            font-weight: bold;
        }

        .products-table tr:last-child td {
            border-bottom: none;
        }

        .products-table tr:hover {
            background: rgba(65, 90, 119, 0.3);
        }

        .product-image-small {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }

        /* أزرار الإجراءات */
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .action-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-button {
            background: #457b9d;
            color: white;
        }

        .edit-button:hover {
            background: #1d3557;
            transform: scale(1.1);
        }

        .delete-button {
            background: #e63946;
            color: white;
        }

        .delete-button:hover {
            background: #c1121f;
            transform: scale(1.1);
        }

        /* نموذج إضافة/تعديل المنتج */
        .product-form {
            background: linear-gradient(145deg, #1b263b, #0d1b2a);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
            display: none;
        }

        .form-title {
            color: #a8dadc;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #a8dadc;
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: rgba(13, 27, 42, 0.7);
            border: 1px solid #415a77;
            border-radius: 8px;
            color: #e0e1dd;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #a8dadc;
            box-shadow: 0 0 0 2px rgba(168, 218, 220, 0.3);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
        }

        .image-preview {
            width: 100%;
            height: 200px;
            background: rgba(13, 27, 42, 0.7);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .gallery-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .gallery-item {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: #e63946;
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .add-gallery-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            background: rgba(13, 27, 42, 0.7);
            border: 1px dashed #415a77;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #a8dadc;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-gallery-image:hover {
            background: rgba(65, 90, 119, 0.3);
        }

        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .submit-button {
            background: linear-gradient(to right, #2a9d8f, #1d6b5e);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-button:hover {
            background: linear-gradient(to right, #1d6b5e, #2a9d8f);
            transform: translateY(-3px);
        }

        .cancel-button {
            background: transparent;
            color: #a8dadc;
            border: 2px solid #457b9d;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cancel-button:hover {
            background: rgba(69, 123, 157, 0.2);
        }

        /* زر إضافة منتج جديد */
        .add-product-button {
            background: linear-gradient(to right, #2a9d8f, #1d6b5e);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0 auto 30px;
            box-shadow: 0 4px 10px rgba(42, 157, 143, 0.4);
        }

        .add-product-button:hover {
            background: linear-gradient(to right, #1d6b5e, #2a9d8f);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(42, 157, 143, 0.6);
        }

        /* قسم الإعدادات */
        .settings-form {
            background: linear-gradient(145deg, #1b263b, #0d1b2a);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
        }

        .settings-group {
            margin-bottom: 30px;
        }

        .settings-title {
            color: #a8dadc;
            margin-bottom: 20px;
            font-size: 1.3rem;
            border-bottom: 1px solid #415a77;
            padding-bottom: 10px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .checkbox-input {
            width: 20px;
            height: 20px;
            margin-left: 10px;
            accent-color: #2a9d8f;
        }

        .checkbox-label {
            color: #e0e1dd;
        }

        /* رسائل النظام */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeIn 0.5s;
            display: none;
        }

        .alert-success {
            background: rgba(42, 157, 143, 0.2);
            border: 1px solid #2a9d8f;
            color: #2a9d8f;
        }

        .alert-error {
            background: rgba(230, 57, 70, 0.2);
            border: 1px solid #e63946;
            color: #e63946;
        }

        .alert-icon {
            font-size: 1.5rem;
        }

        .alert-message {
            flex-grow: 1;
        }

        .alert-close {
            background: none;
            border: none;
            color: inherit;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .alert-close:hover {
            transform: rotate(90deg);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* التكيف مع الشاشات الصغيرة */
        @media (max-width: 768px) {
            .admin-nav {
                flex-wrap: wrap;
            }
            
            .form-row {
                flex-direction: column;
                gap: 20px;
            }
            
            .products-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* قسم الأقسام المختلفة */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* زر العودة للمتجر */
        .store-link {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(to right, #457b9d, #1d3557);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .store-link:hover {
            background: linear-gradient(to right, #1d3557, #457b9d);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
        }

        /* مؤشر التحميل */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #a8dadc;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* تنسيق الصور المتعددة */
        .badge-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .badge-option {
            padding: 8px 15px;
            background: rgba(13, 27, 42, 0.7);
            border: 1px solid #415a77;
            border-radius: 20px;
            color: #e0e1dd;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .badge-option.selected {
            background: #457b9d;
            border-color: #457b9d;
        }

        .badge-option:hover:not(.selected) {
            background: rgba(65, 90, 119, 0.3);
        }

        /* زر تسجيل الخروج */
        .logout-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #e63946;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 101;
        }

        .logout-button:hover {
            background: #c1121f;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- شاشة تسجيل الدخول -->
    <div id="login-screen">
        <div class="login-container">
            <div class="login-logo">
                <i class="fas fa-store"></i>
            </div>
            <h2 class="login-title">تسجيل الدخول للوحة التحكم</h2>
            <div class="login-form">
                <input type="password" id="password-input" class="login-input" placeholder="كلمة المرور" autocomplete="current-password">
                <button id="login-button" class="login-button">دخول</button>
                <div id="login-error" class="login-error">كلمة المرور غير صحيحة</div>
            </div>
        </div>
    </div>

    <!-- مؤشر التحميل -->
    <div class="loading">
        <div class="spinner"></div>
    </div>

    <!-- زر تسجيل الخروج -->
    <button class="logout-button" id="logout-button" title="تسجيل الخروج">
        <i class="fas fa-sign-out-alt"></i>
    </button>

    <!-- القائمة الرئيسية (بدون ترويسة) -->
    <div class="admin-nav">
        <button class="nav-button active" data-tab="products">
            <i class="fas fa-box"></i> المنتجات
        </button>
        <button class="nav-button" data-tab="settings">
            <i class="fas fa-cog"></i> الإعدادات
        </button>
    </div>

    <!-- رسائل النظام -->
    <div class="container">
        <div class="alert alert-success">
            <i class="fas fa-check-circle alert-icon"></i>
            <div class="alert-message">تمت العملية بنجاح!</div>
            <button class="alert-close"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="alert alert-error">
            <i class="fas fa-exclamation-circle alert-icon"></i>
            <div class="alert-message">حدث خطأ أثناء العملية!</div>
            <button class="alert-close"><i class="fas fa-times"></i></button>
        </div>
    </div>

    <!-- المحتوى الرئيسي -->
    <div class="container">
        <!-- قسم المنتجات -->
        <div class="tab-content active" id="products-tab">
            <h2 class="section-title">إدارة المنتجات</h2>
            
            <!-- زر إضافة منتج جديد -->
            <button class="add-product-button" id="add-product-btn">
                <i class="fas fa-plus"></i> إضافة منتج جديد
            </button>
            
            <!-- نموذج إضافة/تعديل المنتج -->
            <div class="product-form" id="product-form">
                <h3 class="form-title" id="form-title">إضافة منتج جديد</h3>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label class="form-label">اسم المنتج</label>
                            <input type="text" class="form-control" id="product-name" placeholder="أدخل اسم المنتج">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">وصف المنتج</label>
                            <textarea class="form-control" id="product-description" placeholder="أدخل وصف المنتج"></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label">السعر (SAR)</label>
                                    <input type="number" class="form-control" id="product-price" placeholder="أدخل السعر">
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label">شارة المنتج</label>
                                    <div class="badge-container">
                                        <div class="badge-option" data-badge="جديد">جديد</div>
                                        <div class="badge-option" data-badge="الأكثر مبيعاً">الأكثر مبيعاً</div>
                                        <div class="badge-option" data-badge="خصم">خصم</div>
                                        <div class="badge-option" data-badge="none">بدون</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-col">
                        <div class="form-group">
                            <label class="form-label">الصورة الرئيسية</label>
                            <div class="image-preview" id="main-image-preview">
                                <i class="fas fa-image" style="font-size: 3rem; color: #415a77;"></i>
                            </div>
                            <input type="text" class="form-control" id="product-image" placeholder="أدخل رابط الصورة الرئيسية">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">معرض الصور (اختياري)</label>
                            <div class="gallery-container" id="gallery-container">
                                <div class="add-gallery-image" id="add-gallery-btn">
                                    <i class="fas fa-plus"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-buttons">
                    <button class="submit-button" id="save-product-btn">حفظ المنتج</button>
                    <button class="cancel-button" id="cancel-form-btn">إلغاء</button>
                </div>
            </div>
            
            <!-- جدول المنتجات -->
            <table class="products-table">
                <thead>
                    <tr>
                        <th>الصورة</th>
                        <th>اسم المنتج</th>
                        <th>السعر</th>
                        <th>الشارة</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody id="products-table-body">
                    <!-- سيتم إضافة المنتجات هنا ديناميكياً -->
                </tbody>
            </table>
        </div>
        
        <!-- قسم الإعدادات -->
        <div class="tab-content" id="settings-tab">
            <h2 class="section-title">إعدادات المتجر</h2>
            
            <div class="settings-form">
                <div class="settings-group">
                    <h3 class="settings-title">إعدادات العرض</h3>
                    
                    <div class="form-group">
                        <label class="form-label">رابط صورة الهيدر</label>
                        <input type="text" class="form-control" id="header-image-url" placeholder="أدخل رابط صورة الهيدر">
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="fixed-header" class="checkbox-input">
                        <label for="fixed-header" class="checkbox-label">تثبيت الهيدر أثناء التمرير</label>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="mobile-only" class="checkbox-input" checked>
                        <label for="mobile-only" class="checkbox-label">عرض المتجر على الجوال فقط</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="show-badges" class="checkbox-input" checked>
                        <label for="show-badges" class="checkbox-label">عرض شارات المنتجات</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="show-gallery" class="checkbox-input" checked>
                        <label for="show-gallery" class="checkbox-label">عرض معرض الصور للمنتجات</label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3 class="settings-title">إعدادات التواصل</h3>
                    
                    <div class="form-group">
                        <label class="form-label">رقم الواتساب</label>
                        <input type="text" class="form-control" id="whatsapp-number" placeholder="أدخل رقم الواتساب بالتنسيق الدولي (بدون +)" value="966554986678">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-control" id="email" placeholder="أدخل البريد الإلكتروني" value="info@khiran-store.com">
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">إعدادات الأمان</h3>
                    
                    <div class="form-group">
                        <label class="form-label">تغيير كلمة المرور</label>
                        <input type="password" class="form-control" id="new-password" placeholder="أدخل كلمة المرور الجديدة">
                    </div>
                </div>
                
                <div class="form-buttons">
                    <button class="submit-button" id="save-settings-btn">حفظ الإعدادات</button>
                </div>
            </div>
        </div>
    </div>

    <!-- زر العودة للمتجر -->
    <a href="index.html" class="store-link" title="العودة للمتجر">
        <i class="fas fa-store"></i>
    </a>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // نظام تسجيل الدخول
            const loginScreen = document.getElementById('login-screen');
            const passwordInput = document.getElementById('password-input');
            const loginButton = document.getElementById('login-button');
            const loginError = document.getElementById('login-error');
            const logoutButton = document.getElementById('logout-button');
            
            // كلمة المرور الافتراضية
            const defaultPassword = '123456';
            
            // التحقق من حالة تسجيل الدخول
            function checkLoginStatus() {
                const isLoggedIn = localStorage.getItem('admin_logged_in');
                if (isLoggedIn === 'true') {
                    loginScreen.style.display = 'none';
                } else {
                    loginScreen.style.display = 'flex';
                }
            }
            
            // تسجيل الدخول
            loginButton.addEventListener('click', () => {
                const password = passwordInput.value.trim();
                const savedPassword = localStorage.getItem('admin_password') || defaultPassword;
                
                if (password === savedPassword) {
                    localStorage.setItem('admin_logged_in', 'true');
                    loginScreen.style.display = 'none';
                    loginError.style.display = 'none';
                    passwordInput.value = '';
                } else {
                    loginError.style.display = 'block';
                    passwordInput.value = '';
                }
            });
            
            // تسجيل الدخول عند الضغط على Enter
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loginButton.click();
                }
            });
            
            // تسجيل الخروج
            logoutButton.addEventListener('click', () => {
                localStorage.removeItem('admin_logged_in');
                loginScreen.style.display = 'flex';
            });
            
            // التحقق من حالة تسجيل الدخول عند تحميل الصفحة
            checkLoginStatus();
            
            // تهيئة المتغيرات
            let products = JSON.parse(localStorage.getItem('admin_products')) || [];
            let editingProductId = null;
            let selectedBadge = 'none';
            let galleryImages = [];
            
            // إعدادات المتجر
            const storeSettings = JSON.parse(localStorage.getItem('store_settings')) || {
                mobileOnly: true,
                showBadges: true,
                showGallery: true,
                whatsappNumber: '966554986678',
                email: 'info@khiran-store.com',
                headerImageUrl: 'https://images.unsplash.com/photo-1563013544-824ae1b704d3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80', // رابط افتراضي
                fixedHeader: true // افتراضي: مثبت
            };
            
            // تحميل الإعدادات
            document.getElementById('header-image-url').value = storeSettings.headerImageUrl;
            document.getElementById('fixed-header').checked = storeSettings.fixedHeader;
            document.getElementById('mobile-only').checked = storeSettings.mobileOnly;
            document.getElementById('show-badges').checked = storeSettings.showBadges;
            document.getElementById('show-gallery').checked = storeSettings.showGallery;
            document.getElementById('whatsapp-number').value = storeSettings.whatsappNumber;
            document.getElementById('email').value = storeSettings.email;
            
            // التبديل بين الأقسام
            const navButtons = document.querySelectorAll('.nav-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;
                    
                    // تحديث الأزرار النشطة
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // تحديث المحتوى النشط
                    tabContents.forEach(tab => {
                        if (tab.id === `${tabId}-tab`) {
                            tab.classList.add('active');
                        } else {
                            tab.classList.remove('active');
                        }
                    });
                });
            });
            
            // إغلاق رسائل النظام
            const alertCloseButtons = document.querySelectorAll('.alert-close');
            alertCloseButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const alert = button.closest('.alert');
                    alert.style.display = 'none';
                });
            });
            
            // عرض رسالة نظام
            function showAlert(type, message) {
                const alert = document.querySelector(`.alert-${type}`);
                alert.querySelector('.alert-message').textContent = message;
                alert.style.display = 'flex';
                
                // إخفاء الرسالة بعد 5 ثوان
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 5000);
            }
            
            // تحديث جدول المنتجات
            function updateProductsTable() {
                const tableBody = document.getElementById('products-table-body');
                tableBody.innerHTML = '';
                
                if (products.length === 0) {
                    const emptyRow = document.createElement('tr');
                    emptyRow.innerHTML = `
                        <td colspan="5" style="text-align: center; padding: 30px;">
                            لا توجد منتجات حالياً. أضف منتجات جديدة باستخدام زر "إضافة منتج جديد".
                        </td>
                    `;
                    tableBody.appendChild(emptyRow);
                    return;
                }
                
                products.forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <img src="${product.image}" alt="${product.name}" class="product-image-small">
                        </td>
                        <td>${product.name}</td>
                        <td>${product.price} SAR</td>
                        <td>${product.badge !== 'none' ? product.badge : '-'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-button edit-button" data-id="${product.id}" title="تعديل">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-button delete-button" data-id="${product.id}" title="حذف">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
                
                // حفظ المنتجات في localStorage
                localStorage.setItem('admin_products', JSON.stringify(products));
            }
            
            // تحديث المنتجات في الصفحة الرئيسية
            function updateStoreProducts() {
                localStorage.setItem('store_products', JSON.stringify(products));
            }
            
            // إضافة منتج جديد
            document.getElementById('add-product-btn').addEventListener('click', () => {
                // إعادة تعيين النموذج
                document.getElementById('form-title').textContent = 'إضافة منتج جديد';
                document.getElementById('product-name').value = '';
                document.getElementById('product-description').value = '';
                document.getElementById('product-price').value = '';
                document.getElementById('product-image').value = '';
                document.getElementById('main-image-preview').innerHTML = '<i class="fas fa-image" style="font-size: 3rem; color: #415a77;"></i>';
                
                // إعادة تعيين معرض الصور
                galleryImages = [];
                const galleryContainer = document.getElementById('gallery-container');
                galleryContainer.innerHTML = `
                    <div class="add-gallery-image" id="add-gallery-btn">
                        <i class="fas fa-plus"></i>
                    </div>
                `;
                
                // إعادة تعيين الشارة
                selectedBadge = 'none';
                document.querySelectorAll('.badge-option').forEach(option => {
                    option.classList.remove('selected');
                    if (option.dataset.badge === 'none') {
                        option.classList.add('selected');
                    }
                });
                
                // إعادة تعيين معرف المنتج
                editingProductId = null;
                
                // عرض النموذج
                document.getElementById('product-form').style.display = 'block';
                
                // التمرير إلى النموذج
                document.getElementById('product-form').scrollIntoView({ behavior: 'smooth' });
            });
            
            // معاينة الصورة الرئيسية
            document.getElementById('product-image').addEventListener('input', function() {
                const imageUrl = this.value.trim();
                const imagePreview = document.getElementById('main-image-preview');
                
                if (imageUrl) {
                    imagePreview.innerHTML = `<img src="${imageUrl}" alt="معاينة الصورة">`;
                } else {
                    imagePreview.innerHTML = '<i class="fas fa-image" style="font-size: 3rem; color: #415a77;"></i>';
                }
            });
            
            // إضافة صورة للمعرض
            document.getElementById('gallery-container').addEventListener('click', (e) => {
                if (e.target.closest('#add-gallery-btn')) {
                    const imageUrl = prompt('أدخل رابط الصورة:');
                    if (imageUrl && imageUrl.trim()) {
                        addGalleryImage(imageUrl.trim());
                    }
                }
            });
            
            // إضافة صورة للمعرض
            function addGalleryImage(imageUrl) {
                galleryImages.push(imageUrl);
                
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.innerHTML = `
                    <img src="${imageUrl}" alt="صورة المعرض">
                    <button class="remove-image" data-url="${imageUrl}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                const addButton = document.getElementById('add-gallery-btn');
                document.getElementById('gallery-container').insertBefore(galleryItem, addButton);
                
                // إضافة حدث إزالة الصورة
                galleryItem.querySelector('.remove-image').addEventListener('click', function(e) {
                    e.stopPropagation();
                    const url = this.dataset.url;
                    galleryImages = galleryImages.filter(img => img !== url);
                    galleryItem.remove();
                });
            }
            
            // اختيار شارة المنتج
            document.querySelectorAll('.badge-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.badge-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedBadge = this.dataset.badge;
                });
            });
            
            // حفظ المنتج
            document.getElementById('save-product-btn').addEventListener('click', () => {
                // التحقق من الحقول المطلوبة
                const name = document.getElementById('product-name').value.trim();
                const description = document.getElementById('product-description').value.trim();
                const price = document.getElementById('product-price').value.trim();
                const image = document.getElementById('product-image').value.trim();
                
                if (!name || !description || !price || !image) {
                    showAlert('error', 'يرجى ملء جميع الحقول المطلوبة!');
                    return;
                }
                
                // إنشاء كائن المنتج
                const product = {
                    id: editingProductId || Date.now().toString(),
                    name,
                    description,
                    price: parseInt(price),
                    image,
                    badge: selectedBadge,
                    gallery: galleryImages
                };
                
                // إضافة أو تحديث المنتج
                if (editingProductId) {
                    // تحديث منتج موجود
                    const index = products.findIndex(p => p.id === editingProductId);
                    if (index !== -1) {
                        products[index] = product;
                        showAlert('success', 'تم تحديث المنتج بنجاح!');
                    }
                } else {
                    // إضافة منتج جديد
                    products.push(product);
                    showAlert('success', 'تمت إضافة المنتج بنجاح!');
                }
                
                // تحديث جدول المنتجات
                updateProductsTable();
                
                // تحديث المنتجات في الصفحة الرئيسية
                updateStoreProducts();
                
                // إخفاء النموذج
                document.getElementById('product-form').style.display = 'none';
            });
            
            // إلغاء النموذج
            document.getElementById('cancel-form-btn').addEventListener('click', () => {
                document.getElementById('product-form').style.display = 'none';
            });
            
            // تعديل منتج
            document.addEventListener('click', (e) => {
                if (e.target.closest('.edit-button')) {
                    const button = e.target.closest('.edit-button');
                    const productId = button.dataset.id;
                    const product = products.find(p => p.id === productId);
                    
                    if (product) {
                        // تعيين عنوان النموذج
                        document.getElementById('form-title').textContent = 'تعديل المنتج';
                        
                        // ملء بيانات المنتج
                        document.getElementById('product-name').value = product.name;
                        document.getElementById('product-description').value = product.description;
                        document.getElementById('product-price').value = product.price;
                        document.getElementById('product-image').value = product.image;
                        document.getElementById('main-image-preview').innerHTML = `<img src="${product.image}" alt="معاينة الصورة">`;
                        
                        // تعيين الشارة
                        selectedBadge = product.badge || 'none';
                        document.querySelectorAll('.badge-option').forEach(option => {
                            option.classList.remove('selected');
                            if (option.dataset.badge === selectedBadge) {
                                option.classList.add('selected');
                            }
                        });
                        
                        // تعيين معرض الصور
                        galleryImages = product.gallery || [];
                        const galleryContainer = document.getElementById('gallery-container');
                        galleryContainer.innerHTML = `
                            <div class="add-gallery-image" id="add-gallery-btn">
                                <i class="fas fa-plus"></i>
                            </div>
                        `;
                        
                        galleryImages.forEach(url => {
                            const galleryItem = document.createElement('div');
                            galleryItem.className = 'gallery-item';
                            galleryItem.innerHTML = `
                                <img src="${url}" alt="صورة المعرض">
                                <button class="remove-image" data-url="${url}">
                                    <i class="fas fa-times"></i>
                                </button>
                            `;
                            
                            const addButton = document.getElementById('add-gallery-btn');
                            galleryContainer.insertBefore(galleryItem, addButton);
                            
                            // إضافة حدث إزالة الصورة
                            galleryItem.querySelector('.remove-image').addEventListener('click', function(e) {
                                e.stopPropagation();
                                const imageUrl = this.dataset.url;
                                galleryImages = galleryImages.filter(img => img !== imageUrl);
                                galleryItem.remove();
                            });
                        });
                        
                        // تعيين معرف المنتج
                        editingProductId = productId;
                        
                        // عرض النموذج
                        document.getElementById('product-form').style.display = 'block';
                        
                        // التمرير إلى النموذج
                        document.getElementById('product-form').scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
            
            // حذف منتج
            document.addEventListener('click', (e) => {
                if (e.target.closest('.delete-button')) {
                    const button = e.target.closest('.delete-button');
                    const productId = button.dataset.id;
                    
                    if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                        products = products.filter(p => p.id !== productId);
                        updateProductsTable();
                        updateStoreProducts();
                        showAlert('success', 'تم حذف المنتج بنجاح!');
                    }
                }
            });
            
            // حفظ الإعدادات
            document.getElementById('save-settings-btn').addEventListener('click', () => {
                // تحديث الإعدادات
                storeSettings.headerImageUrl = document.getElementById('header-image-url').value.trim();
                storeSettings.fixedHeader = document.getElementById('fixed-header').checked;
                storeSettings.mobileOnly = document.getElementById('mobile-only').checked;
                storeSettings.showBadges = document.getElementById('show-badges').checked;
                storeSettings.showGallery = document.getElementById('show-gallery').checked;
                storeSettings.whatsappNumber = document.getElementById('whatsapp-number').value.trim();
                storeSettings.email = document.getElementById('email').value.trim();
                
                // حفظ الإعدادات
                localStorage.setItem('store_settings', JSON.stringify(storeSettings));
                
                // تحديث كلمة المرور إذا تم إدخالها
                const newPassword = document.getElementById('new-password').value.trim();
                if (newPassword) {
                    localStorage.setItem('admin_password', newPassword);
                    document.getElementById('new-password').value = '';
                }
                
                showAlert('success', 'تم حفظ الإعدادات بنجاح!');
            });
            
            // تحميل المنتجات الافتراضية إذا لم تكن موجودة
            if (products.length === 0) {
                // المنتج 1
                products.push({
                    id: '1',
                    name: 'ساعة ذكية فاخرة',
                    description: 'ساعة ذكية بتصميم أنيق مع شاشة AMOLED واضحة، مقاومة للماء، وتتبع النوم والنشاط البدني، بطارية تدوم 7 أيام.',
                    price: 599,
                    image: 'https://images.unsplash.com/photo-1546868871-7041f2a55e12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                    badge: 'جديد',
                    gallery: [
                        'https://images.unsplash.com/photo-1523275335684-37898b6baf30?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1546868871-7041f2a55e12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1579586337278-3befd40fd17a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80'
                    ]
                });
                
                // المنتج 2
                products.push({
                    id: '2',
                    name: 'سماعات لاسلكية',
                    description: 'سماعات بلوتوث عالية الجودة مع عزل ضوضاء فعال، بطارية تدوم 30 ساعة، مقاومة للماء والعرق، مع جودة صوت استثنائية.',
                    price: 349,
                    image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                    badge: 'الأكثر مبيعاً',
                    gallery: [
                        'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1572536147248-ac59a8abfa4b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1590658268037-6bf12165a8df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80'
                    ]
                });
                
                // المنتج 3
                products.push({
                    id: '3',
                    name: 'هاتف ذكي متطور',
                    description: 'هاتف ذكي بمعالج سريع، شاشة AMOLED 6.7 بوصة، كاميرا رباعية بدقة 108 ميجابكسل، بطارية 5000mAh، مع نظام تشغيل حديث.',
                    price: 2799,
                    image: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                    badge: 'خصم 15%',
                    gallery: [
                        'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1605236453806-6ff36851218e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80',
                        'https://images.unsplash.com/photo-1601784551446-20c9e07cdbdb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&q=80'
                    ]
                });
            }
            
            // تحديث جدول المنتجات
            updateProductsTable();
            
            // تحديث المنتجات في الصفحة الرئيسية
            updateStoreProducts();
        });
    </script>
</body>
</html>
